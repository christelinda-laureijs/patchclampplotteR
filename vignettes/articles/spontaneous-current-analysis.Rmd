---
title: "Spontaneous Current Analysis"
---

```{r spontaneous-setup, include = FALSE}
knitr::opts_chunk$set(
  fig.align = "center",
  out.extra='',
  out.width="75%",
  echo = FALSE
)

library(reactable)
```

This article will show you how to analyze spontaneous currents in raw .abf recordings using Event Detection in Clampfit. The data will then be ready for further analyses with `patchclampplotteR`. Many steps at the beginning are the same as the ones in the [Evoked current analysis](https://christelinda-laureijs.github.io/patchclampplotteR/articles/evoked-current-analysis.html) article, but new processes will begin starting in step 5.


## Combine recordings

> The data from our lab is not a continuous 30-minute recording. We pause the recording every 5 minutes to obtain parameters like access resistance and capacitance from the membrane test before resuming recording. If your data is already a continuous file, you can skip steps 1-2.

> You may already have a concatenated file from your [Evoked current analysis](https://christelinda-laureijs.github.io/patchclampplotteR/articles/evoked-current-analysis.html). This also means you can skip steps 1-2.

1. Open the first .abf file in your recording series, and use the `Next File` button to quickly open all files in the series.

2. Click on `Analyze` -> `Concatenate Files` and select all files that belong to a recording from a single cell. All the recordings will be combined into a continuous recording with no gaps. 

```{r concatenate, fig.alt = "A screenshot of the Concatenate files dialog box in Clampfit showing that all files are selected."}
knitr::include_graphics("figures/Concatenate-files.png")
```

## View recording

3. Click on the `Show Aquistion Signals` button and then `Previous Signal` (blue arrow in the figure below) to view the sweeps showing changes in current (`Im_primary ()`). The traces should all be stacked on top of each other, but if they are not, click on `View` -> `Data Display` -> `Sweeps`.

4. You can also click on the `Auto Scale All Y Axes` button (orange arrow) to help you see the data faster.

```{r viewer-buttons, out.width="25%", fig.alt = "A screenshot of the Show Signals buttons and other viewering buttons available in the upper toolbar in Clampfit."}
knitr::include_graphics("figures/Viewer-buttons.png")
```

## Create data sheet

5. Create a .csv file with six columns: `Letter`, `ID`, `Trace`, `Peak_amplitude` and `Time_of_peak`.  

* `Letter` The unique letter identifier of a single cell.
* `ID` A character value indicating the recording number. This corresponds to the `File Name` column that is automatically generated in the Results sheet in Clampfit. See below for a warning about what you should put here.
* `Trace`
* `Peak_amplitude` 
* `Time_of_peak`

> I would strongly recommend using the filename of the first file in the series (but write down the concatenated filename in your lab book as well). This is because Clampfit will auto-generate the concatenated file names (`Concatenate001.abf`, `Concatenate002.abf`, etc.). If you update your pClamp software, Clampfit will begin naming files again at `Concatenate000.abf`, and you could lose track of which file is which.

## Identify baseline

6. Zoom into a region of the recording with few spontaneous currents and minimal noise.

> You may need to view a smaller number of traces if there are too many to find a clear region. Use `View` -> `Select sweeps` and select a smaller range.

