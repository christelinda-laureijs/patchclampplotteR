<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot action potential recording — plot_AP_trace • patchclampplotteR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot action potential recording — plot_AP_trace"><meta name="description" content="This function allows you to plot an .abf file of a recording taken in current clamp mode. It is useful if you want to display a representative trace of action potentials or the results of a current injection protocol."><meta property="og:description" content="This function allows you to plot an .abf file of a recording taken in current clamp mode. It is useful if you want to display a representative trace of action potentials or the results of a current injection protocol."><meta property="og:image" content="https://christelinda-laureijs.github.io/patchclampplotteR/logo.png"><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-M92L6F0ZB2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M92L6F0ZB2');
</script><link rel="icon" type="image/x-icon" href="favicon.ico"><link rel="icon" type="image/x-icon" href="../favicon.ico"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">patchclampplotteR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/patchclampplotteR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/evoked-current-analysis.html">Evoked Current Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/action-potential-analysis.html">Action Potential Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/spontaneous-current-analysis.html">Spontaneous Current Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/FAQ.html">FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/christelinda-laureijs/patchclampplotteR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot action potential recording</h1>
      <small class="dont-index">Source: <a href="https://github.com/christelinda-laureijs/patchclampplotteR/blob/main/R/Plot-data.R" class="external-link"><code>R/Plot-data.R</code></a></small>
      <div class="d-none name"><code>plot_AP_trace.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function allows you to plot an <code>.abf</code> file of a recording taken in current clamp mode. It is useful if you want to display a representative trace of action potentials or the results of a current injection protocol.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_AP_trace</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  y_var <span class="op">=</span> <span class="st">"voltage"</span>,</span>
<span>  <span class="va">sweeps</span>,</span>
<span>  <span class="va">colour_scale_option</span>,</span>
<span>  custom_scale_colours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">trace_colour</span>,</span>
<span>  line_width <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  <span class="va">plot_category</span>,</span>
<span>  <span class="va">plot_treatment</span>,</span>
<span>  <span class="va">state</span>,</span>
<span>  include_scale_bar <span class="op">=</span> <span class="st">"yes"</span>,</span>
<span>  scale_bar_label_y_nudge <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  include_scale_bar_label <span class="op">=</span> <span class="st">"yes"</span>,</span>
<span>  geom_text_family <span class="op">=</span> <span class="st">""</span>,</span>
<span>  scale_bar_x_start <span class="op">=</span> <span class="fl">880</span>,</span>
<span>  scale_bar_x_length <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  scale_bar_x_unit <span class="op">=</span> <span class="st">"ms"</span>,</span>
<span>  scaling_factor <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  scale_bar_y_start <span class="op">=</span> <span class="op">-</span><span class="fl">30</span>,</span>
<span>  scale_bar_y_length <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  scale_bar_y_unit <span class="op">=</span> <span class="st">"mV"</span>,</span>
<span>  scale_bar_linewidth <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  save_plot_png <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>  <span class="va">filename_suffix</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A dataframe generated using <code><a href="import_ABF_file.html">import_ABF_file()</a></code> with <code>recording_mode = "current_clamp"</code>.</p></dd>


<dt id="arg-y-var">y_var<a class="anchor" aria-label="anchor" href="#arg-y-var"></a></dt>
<dd><p>A character value ("voltage" or "current") describing what variable will be plotted on the y-axis. Defaults to "voltage". Use "current" if you want to demonstrate current injections.</p></dd>


<dt id="arg-sweeps">sweeps<a class="anchor" aria-label="anchor" href="#arg-sweeps"></a></dt>
<dd><p>A character value or list of character values of the sweeps you would like to plot. These correspond to the values in the <code>sweep1</code> column of your dataset, and will likely be in the form of "epi1", "epi2", etc.</p></dd>


<dt id="arg-colour-scale-option">colour_scale_option<a class="anchor" aria-label="anchor" href="#arg-colour-scale-option"></a></dt>
<dd><p>A character value ("viridis", "custom" or "single_colour") describing what colour scale should be applied to the trace. If set to "viridis" or "custom", the trace will be coloured by sweep.</p></dd>


<dt id="arg-custom-scale-colours">custom_scale_colours<a class="anchor" aria-label="anchor" href="#arg-custom-scale-colours"></a></dt>
<dd><p>A list of character values (can be hex values or named colours) describing the custom theme. Use if <code>colour_scale_option = "custom"</code>.</p></dd>


<dt id="arg-trace-colour">trace_colour<a class="anchor" aria-label="anchor" href="#arg-trace-colour"></a></dt>
<dd><p>A hex value of the colour of the lineplot. Use if <code>colour_scale_option = "single_colour</code>.</p></dd>


<dt id="arg-line-width">line_width<a class="anchor" aria-label="anchor" href="#arg-line-width"></a></dt>
<dd><p>A numeric value specifying the width of the lineplot</p></dd>


<dt id="arg-plot-category">plot_category<a class="anchor" aria-label="anchor" href="#arg-plot-category"></a></dt>
<dd><p>A numeric value specifying the category, which can be
used to differentiate different protocol types. In the sample dataset for
this package, <code>plot_category == 2</code> represents experiments where insulin was
applied continuously after a 5-minute baseline period.</p></dd>


<dt id="arg-plot-treatment">plot_treatment<a class="anchor" aria-label="anchor" href="#arg-plot-treatment"></a></dt>
<dd><p>A character value specifying the treatment you would
like to plot (e.g. "Control"). <code>plot_treatment</code> represents antagonists that
were present on the brain slice, or the animals were fasted, etc.</p></dd>


<dt id="arg-state">state<a class="anchor" aria-label="anchor" href="#arg-state"></a></dt>
<dd><p>A character value describing if the recording was taken during the baseline period or post-treatment/protocol. Examples include "Baseline", "Post-insulin". The <code>state</code> will be included in the .png filename if <code>save_plot_png = "yes"</code>.</p></dd>


<dt id="arg-include-scale-bar">include_scale_bar<a class="anchor" aria-label="anchor" href="#arg-include-scale-bar"></a></dt>
<dd><p>A character value that determines if a scale bar
will be added to the plot. Allowed values are "yes" and "no".</p></dd>


<dt id="arg-scale-bar-label-y-nudge">scale_bar_label_y_nudge<a class="anchor" aria-label="anchor" href="#arg-scale-bar-label-y-nudge"></a></dt>
<dd><p>An optional numeric value that will add additional padding between the scale bar x-axis label and the scale bar. Defaults to 5.</p></dd>


<dt id="arg-include-scale-bar-label">include_scale_bar_label<a class="anchor" aria-label="anchor" href="#arg-include-scale-bar-label"></a></dt>
<dd><p>A character value ("yes" or "no") describing whether to include text labels on the scale bar. If "yes", the text annotation values will be pulled from <code>scale_bar_x_length</code> and <code>scale_bar_y_length</code>.</p></dd>


<dt id="arg-geom-text-family">geom_text_family<a class="anchor" aria-label="anchor" href="#arg-geom-text-family"></a></dt>
<dd><p>A character value describing the font family used for the scale bar annotations. Defaults to "", but can be replaced with a named font. Use a package like <code>extrafont</code> to load system fonts into R.</p></dd>


<dt id="arg-scale-bar-x-start">scale_bar_x_start<a class="anchor" aria-label="anchor" href="#arg-scale-bar-x-start"></a></dt>
<dd><p>A numeric value (in <code>scale_bar_x_unit</code>s, so likely milliseconds) describing the x-axis position of
the scale bar (default is 880).</p></dd>


<dt id="arg-scale-bar-x-length">scale_bar_x_length<a class="anchor" aria-label="anchor" href="#arg-scale-bar-x-length"></a></dt>
<dd><p>A numeric value describing the horizontal span (in <code>scale_bar_x_unit</code>s, so likely milliseconds) of the scale bar (default is 100).</p></dd>


<dt id="arg-scale-bar-x-unit">scale_bar_x_unit<a class="anchor" aria-label="anchor" href="#arg-scale-bar-x-unit"></a></dt>
<dd><p>A character value (defaults to "ms") which will be present on the scale bar label.</p></dd>


<dt id="arg-scaling-factor">scaling_factor<a class="anchor" aria-label="anchor" href="#arg-scaling-factor"></a></dt>
<dd><p>A numeric value describing the scaling factor applied by Clampfit to convert recording time to time in milliseconds. The default is 10, and this value will likely not need to be changed.</p></dd>


<dt id="arg-scale-bar-y-start">scale_bar_y_start<a class="anchor" aria-label="anchor" href="#arg-scale-bar-y-start"></a></dt>
<dd><p>A numeric value describing the y-axis position (in <code>scale_bar_x_unit</code>s, so likely mV) of
the scale bar (default is -30).</p></dd>


<dt id="arg-scale-bar-y-length">scale_bar_y_length<a class="anchor" aria-label="anchor" href="#arg-scale-bar-y-length"></a></dt>
<dd><p>A numeric value describing the vertical span (in <code>scale_bar_x_unit</code>s, so likely mV) of the scale bar (default is 40).</p></dd>


<dt id="arg-scale-bar-y-unit">scale_bar_y_unit<a class="anchor" aria-label="anchor" href="#arg-scale-bar-y-unit"></a></dt>
<dd><p>A character value (defaults to "mV") which will be present on the scale bar label.</p></dd>


<dt id="arg-scale-bar-linewidth">scale_bar_linewidth<a class="anchor" aria-label="anchor" href="#arg-scale-bar-linewidth"></a></dt>
<dd><p>A numeric value describing the thickness of the scalebar line (default is 0.6).</p></dd>


<dt id="arg-save-plot-png">save_plot_png<a class="anchor" aria-label="anchor" href="#arg-save-plot-png"></a></dt>
<dd><p>A character ("yes" or "no"). If "yes", the plot will be
saved as a .png using ggsave. The filepath depends on the current type, but
they will all go in subfolders below Figures/ in your project directory.</p></dd>


<dt id="arg-filename-suffix">filename_suffix<a class="anchor" aria-label="anchor" href="#arg-filename-suffix"></a></dt>
<dd><p>Optional character value to add a suffix to the
filename of the .png file created with this plot. Could be useful if you
have specified a custom list of treatments.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">viridis::scale_color_viridis</a></code> such as <code>begin</code>, <code>end</code>, <code>option</code> and <code>direction</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object. If <code>save_plot_png == "yes"</code>, it will also generate
a .png file in the folder <code>Figures/Action-potentials/Representative-traces</code> relative to the
project directory.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>WARNING: If you choose to plot current injections (<code>y_var = "current"</code>) you MUST change <code>scale_bar_y_unit</code> to the correct unit (likely pA).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="import_ABF_file.html">import_ABF_file()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Viridis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_AP_trace</span><span class="op">(</span></span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="va">sample_ap_abf_baseline</span>,</span></span>
<span class="r-in"><span>sweeps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sample_ap_abf_baseline</span><span class="op">$</span><span class="va">episode</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>colour_scale_option <span class="op">=</span> <span class="st">"viridis"</span>,</span></span>
<span class="r-in"><span>plot_category <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>plot_treatment <span class="op">=</span> <span class="st">"Control"</span>,</span></span>
<span class="r-in"><span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>option <span class="op">=</span> <span class="st">"plasma"</span>,</span></span>
<span class="r-in"><span>begin <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>end <span class="op">=</span> <span class="fl">0.8</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_AP_trace-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Custom colours</span></span></span>
<span class="r-in"><span><span class="fu">plot_AP_trace</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">sample_ap_abf_baseline</span>,</span></span>
<span class="r-in"><span>  sweeps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sample_ap_abf_baseline</span><span class="op">$</span><span class="va">episode</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  custom_scale_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"#edd03a"</span>, <span class="st">"#cced34"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"#a3fd3d"</span>, <span class="st">"#6bfe64"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"#31f199"</span>, <span class="st">"#18dcc3"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"#29bbec"</span>, <span class="st">"#4294ff"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"#466be3"</span>, <span class="st">"#4040a2"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  colour_scale_option <span class="op">=</span> <span class="st">"custom"</span>,</span></span>
<span class="r-in"><span>  plot_category <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  plot_treatment <span class="op">=</span> <span class="st">"Control"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_AP_trace-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Single colour</span></span></span>
<span class="r-in"><span><span class="fu">plot_AP_trace</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">sample_ap_abf_baseline</span>,</span></span>
<span class="r-in"><span>  y_var <span class="op">=</span> <span class="st">"voltage"</span>,</span></span>
<span class="r-in"><span>  sweeps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sample_ap_abf_baseline</span><span class="op">$</span><span class="va">episode</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  colour_scale_option <span class="op">=</span> <span class="st">"single_colour"</span>,</span></span>
<span class="r-in"><span>  trace_colour <span class="op">=</span> <span class="st">"#4294ff"</span>,</span></span>
<span class="r-in"><span>  plot_category <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  plot_treatment <span class="op">=</span> <span class="st">"Control"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_AP_trace-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://christelindalaureijs.com" class="external-link">Christelinda Laureijs</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

